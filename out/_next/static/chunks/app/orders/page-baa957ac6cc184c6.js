(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[778],{6132:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6191:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},11010:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},16485:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},20508:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},20596:(e,s,t)=>{Promise.resolve().then(t.bind(t,73620))},24947:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},26983:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},42529:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},52056:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},64615:(e,s,t)=>{"use strict";t.d(s,{A:()=>f});var a=t(95155),l=t(12115),r=t(52619),i=t.n(r),d=t(95706),n=t(65993),c=t(91169),o=t(89715),m=t(7744),x=t(87066),h=t(26617),u=t(33),p=t(89559),g=t(15870),y=t(65229),j=t(9540),b=t(84926);let v=[{name:"Главная",href:"/",icon:n.A},{name:"Картотека",href:"/carts",icon:c.A},{name:"Заказы",href:"/orders",icon:o.A},{name:"Медицинский отдел",href:"/medical",icon:m.A},{name:"Накладные",href:"/overheads",icon:x.A},{name:"Склад",href:"/warehouse",icon:h.A},{name:"Отчеты",href:"/reports",icon:u.A},{name:"Интеграция",href:"/integration",icon:p.A},{name:"Настройки",href:"/settings",icon:g.A}];function f(e){var s;let{children:t}=e,{user:r,logout:n}=(0,d.A)(),[c,o]=(0,l.useState)(!1),m=async()=>{try{await n()}catch(e){console.error("Logout failed:",e)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:"fixed inset-0 z-50 lg:hidden ".concat(c?"block":"hidden"),children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>o(!1)}),(0,a.jsxs)("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between px-4",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"РУПИО"}),(0,a.jsx)("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(y.A,{className:"h-6 w-6"})})]}),(0,a.jsx)("nav",{className:"flex-1 space-y-1 px-2 py-4",children:v.map(e=>{let s=e.icon;return(0,a.jsxs)(i(),{href:e.href,className:"group flex items-center px-2 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50 hover:text-gray-900",children:[(0,a.jsx)(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]})]}),(0,a.jsx)("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:(0,a.jsxs)("div",{className:"flex flex-col flex-grow bg-white border-r border-gray-200",children:[(0,a.jsx)("div",{className:"flex h-16 items-center px-4",children:(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"РУПИО"})}),(0,a.jsx)("nav",{className:"flex-1 space-y-1 px-2 py-4",children:v.map(e=>{let s=e.icon;return(0,a.jsxs)(i(),{href:e.href,className:"group flex items-center px-2 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50 hover:text-gray-900",children:[(0,a.jsx)(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]})}),(0,a.jsxs)("div",{className:"lg:pl-64",children:[(0,a.jsxs)("div",{className:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-gray-200 bg-white px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8",children:[(0,a.jsx)("button",{type:"button",className:"-m-2.5 p-2.5 text-gray-700 lg:hidden",onClick:()=>o(!0),children:(0,a.jsx)(j.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{className:"flex flex-1 gap-x-4 self-stretch lg:gap-x-6",children:[(0,a.jsx)("div",{className:"flex flex-1"}),(0,a.jsx)("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900",children:[null==r?void 0:r.first_name," ",null==r?void 0:r.last_name]}),(0,a.jsx)("div",{className:"text-gray-500",children:null==r||null==(s=r.role)?void 0:s.name})]}),(0,a.jsx)("button",{onClick:m,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(b.A,{className:"h-5 w-5"})})]})})]})]}),(0,a.jsx)("main",{className:"py-6",children:(0,a.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:t})})]})]})}},71360:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},73620:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var a=t(95155),l=t(12115),r=t(64615),i=t(78894),d=t(65229),n=t(26617),c=t(6132),o=t(16485),m=t(20508);function x(e){var s,t;let{order:r,onSave:x,onCancel:h}=e,[u,p]=(0,l.useState)(r||{}),[g,y]=(0,l.useState)([]),[j,b]=(0,l.useState)([]),[v,f]=(0,l.useState)([]),[N,_]=(0,l.useState)([]),[w,k]=(0,l.useState)([]),[C,A]=(0,l.useState)([]),[F,S]=(0,l.useState)(!1),[q,M]=(0,l.useState)({}),[z,O]=(0,l.useState)("general");(0,l.useEffect)(()=>{(async()=>{try{S(!0);let[e,s,t,a,l,r]=await Promise.all([i.u.getCarts(),i.u.getDeviceTypes(),i.u.getDiagnosisTypes(),i.u.getShoeModels(),i.u.getShoeColors(),i.u.getHeelMaterials()]);y(e.results),b(s),f(t),_(a),k(l),A(r)}catch(e){console.error("Failed to load dictionaries:",e)}finally{S(!1)}})()},[]);let D=e=>{let{name:s,value:t,type:a}=e.target,l="checked"in e.target&&e.target.checked;p(e=>({...e,[s]:"checkbox"===a?l:t})),q[s]&&M(e=>({...e,[s]:""}))},P=(e,s,t)=>{p(a=>{var l;return{...a,measurements:(null==(l=a.measurements)?void 0:l.map((a,l)=>l===e?{...a,[s]:t}:a))||[]}})},H=async e=>{if(e.preventDefault(),(()=>{let e={};return u.cart_id||(e.cart_id="Выберите пациента"),u.device_type_r_id||(e.device_type_r_id="Выберите тип изделия"),u.diagnosis_type_id||(e.diagnosis_type_id="Выберите тип диагноза"),(!u.quantity||u.quantity<=0)&&(e.quantity="Количество должно быть больше 0"),u.diagnosis_side||(e.diagnosis_side="Выберите сторону диагноза"),M(e),0===Object.keys(e).length})())try{S(!0);let e={...u,create_date:u.create_date||new Date().toISOString().split("T")[0],order_status:u.order_status||1,order_payment_type:u.order_payment_type||"Бесплатно",is_urgent:u.is_urgent||!1,cost:u.cost||0,diagnosis_side:u.diagnosis_side||"right",hospitalized:u.hospitalized||!1,order_type:u.order_type||"prosthesis",quantity:u.quantity||1,diagnosis_type_id:u.diagnosis_type_id||1,device_type_r_id:u.device_type_r_id||1,device_type_l_id:u.device_type_l_id||void 0,priority_level:u.priority_level||"normal",urgent_reason:u.urgent_reason||void 0,medical_examination:u.medical_examination||void 0,note:u.note||"",measurements:u.measurements||[],cart:u.cart||g[0],device_type:u.device_type||j[0],diagnosis_type:u.diagnosis_type||v[0],status:u.status||1,created_at:u.created_at||new Date().toISOString(),updated_at:new Date().toISOString(),materials:u.materials||[],works:u.works||[],employees:u.employees||[]};await x(e)}catch(e){console.error("Failed to save order:",e)}finally{S(!1)}},I=g.find(e=>e.id===u.cart_id);return F&&!r?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Загрузка данных..."})]})})}):(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:r?"Редактировать заказ":"Новый заказ"}),(0,a.jsx)("button",{onClick:h,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(d.A,{className:"h-6 w-6"})})]}),(0,a.jsxs)("form",{onSubmit:H,className:"overflow-y-auto max-h-[calc(90vh-120px)]",children:[(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>O("general"),className:"".concat("general"===z?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"," whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium"),children:[(0,a.jsx)(n.A,{className:"h-4 w-4 inline mr-2"}),"Общие данные"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>O("measurements"),className:"".concat("measurements"===z?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"," whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium"),children:[(0,a.jsx)(c.A,{className:"h-4 w-4 inline mr-2"}),"Измерения"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>O("process"),className:"".concat("process"===z?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"," whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium"),children:[(0,a.jsx)(o.A,{className:"h-4 w-4 inline mr-2"}),"Процесс"]})]})}),"general"===z&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsxs)("label",{htmlFor:"cart_id",className:"block text-sm font-medium text-gray-700",children:["Пациент ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{name:"cart_id",id:"cart_id",value:u.cart_id||"",onChange:D,className:"mt-1 block w-full input ".concat(q.cart_id?"border-red-500":""),required:!0,children:[(0,a.jsx)("option",{value:"",children:"Выберите пациента"}),g.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," ",e.first_name," ",e.parent_name," (№",e.card_number,")"]},e.id))]}),q.cart_id&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:q.cart_id})]}),I&&(0,a.jsx)("div",{className:"sm:col-span-2",children:(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(m.A,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-blue-900",children:[I.name," ",I.first_name," ",I.parent_name]}),(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:["ИНН: ",I.inn," | Телефон: ",I.phone_number]})]})]})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"order_type",className:"block text-sm font-medium text-gray-700",children:"Тип заказа"}),(0,a.jsxs)("select",{name:"order_type",id:"order_type",value:u.order_type||"",onChange:D,className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"",children:"Выберите тип"}),(0,a.jsx)("option",{value:"prosthesis",children:"Протез"}),(0,a.jsx)("option",{value:"shoes",children:"Обувь"}),(0,a.jsx)("option",{value:"orthopedic",children:"Ортопедическое"}),(0,a.jsx)("option",{value:"repair",children:"Ремонт"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"quantity",className:"block text-sm font-medium text-gray-700",children:["Количество ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"number",name:"quantity",id:"quantity",min:"1",value:u.quantity||"",onChange:D,className:"mt-1 block w-full input ".concat(q.quantity?"border-red-500":""),required:!0}),q.quantity&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:q.quantity})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"device_type_r_id",className:"block text-sm font-medium text-gray-700",children:["Тип изделия (правая) ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{name:"device_type_r_id",id:"device_type_r_id",value:u.device_type_r_id||"",onChange:D,className:"mt-1 block w-full input ".concat(q.device_type_r_id?"border-red-500":""),required:!0,children:[(0,a.jsx)("option",{value:"",children:"Выберите тип изделия"}),j.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),q.device_type_r_id&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:q.device_type_r_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"device_type_l_id",className:"block text-sm font-medium text-gray-700",children:"Тип изделия (левая)"}),(0,a.jsxs)("select",{name:"device_type_l_id",id:"device_type_l_id",value:u.device_type_l_id||"",onChange:D,className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"",children:"Выберите тип изделия"}),j.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"diagnosis_type_id",className:"block text-sm font-medium text-gray-700",children:["Тип диагноза ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{name:"diagnosis_type_id",id:"diagnosis_type_id",value:u.diagnosis_type_id||"",onChange:D,className:"mt-1 block w-full input ".concat(q.diagnosis_type_id?"border-red-500":""),required:!0,children:[(0,a.jsx)("option",{value:"",children:"Выберите тип диагноза"}),v.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),q.diagnosis_type_id&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:q.diagnosis_type_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"diagnosis_side",className:"block text-sm font-medium text-gray-700",children:["Сторона диагноза ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{name:"diagnosis_side",id:"diagnosis_side",value:u.diagnosis_side||"",onChange:D,className:"mt-1 block w-full input ".concat(q.diagnosis_side?"border-red-500":""),required:!0,children:[(0,a.jsx)("option",{value:"",children:"Выберите сторону"}),(0,a.jsx)("option",{value:"right",children:"Правая"}),(0,a.jsx)("option",{value:"left",children:"Левая"}),(0,a.jsx)("option",{value:"both",children:"Обе"})]}),q.diagnosis_side&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:q.diagnosis_side})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",name:"hospitalized",id:"hospitalized",checked:u.hospitalized||!1,onChange:D,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"hospitalized",className:"ml-2 block text-sm text-gray-900",children:"Госпитализация"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",name:"is_urgent",id:"is_urgent",checked:u.is_urgent||!1,onChange:D,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"is_urgent",className:"ml-2 block text-sm text-gray-900",children:"Срочный заказ"})]}),u.is_urgent&&(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)("label",{htmlFor:"urgent_reason",className:"block text-sm font-medium text-gray-700",children:"Причина срочности"}),(0,a.jsx)("textarea",{name:"urgent_reason",id:"urgent_reason",rows:3,value:u.urgent_reason||"",onChange:D,className:"mt-1 block w-full input",placeholder:"Укажите причину срочности заказа"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"cost",className:"block text-sm font-medium text-gray-700",children:"Стоимость (сом)"}),(0,a.jsx)("input",{type:"number",name:"cost",id:"cost",min:"0",step:"0.01",value:u.cost||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"order_payment_type",className:"block text-sm font-medium text-gray-700",children:"Тип оплаты"}),(0,a.jsxs)("select",{name:"order_payment_type",id:"order_payment_type",value:u.order_payment_type||"",onChange:D,className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"budget",children:"Бюджет"}),(0,a.jsx)("option",{value:"paid",children:"Платная"}),(0,a.jsx)("option",{value:"insurance",children:"Страховая"})]})]})]})}),"measurements"===z&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Измерения"}),(0,a.jsx)("button",{type:"button",onClick:()=>{p(e=>({...e,measurements:[...e.measurements||[],{id:Date.now(),order_id:e.id||0,type:"length",measurement:0,unit:"см",side:"right"}]}))},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Добавить измерение"})]}),(null==(s=u.measurements)?void 0:s.length)===0&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(c.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,a.jsx)("p",{children:"Измерения не добавлены"}),(0,a.jsx)("p",{className:"text-sm",children:'Нажмите "Добавить измерение" для начала работы'})]}),null==(t=u.measurements)?void 0:t.map((e,s)=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-gray-900",children:["Измерение #",s+1]}),(0,a.jsx)("button",{type:"button",onClick:()=>{p(e=>{var t;return{...e,measurements:(null==(t=e.measurements)?void 0:t.filter((e,t)=>t!==s))||[]}})},className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-y-4 sm:grid-cols-4 sm:gap-x-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Тип измерения"}),(0,a.jsx)("input",{type:"text",value:e.type,onChange:e=>P(s,"type",e.target.value),className:"mt-1 block w-full input",placeholder:"Например: Длина культи"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Значение"}),(0,a.jsx)("input",{type:"number",value:e.measurement,onChange:e=>P(s,"measurement",parseFloat(e.target.value)||0),className:"mt-1 block w-full input",step:"0.1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Единица"}),(0,a.jsxs)("select",{value:e.unit,onChange:e=>P(s,"unit",e.target.value),className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"см",children:"см"}),(0,a.jsx)("option",{value:"мм",children:"мм"}),(0,a.jsx)("option",{value:"м",children:"м"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Сторона"}),(0,a.jsxs)("select",{value:e.side,onChange:e=>P(s,"side",e.target.value),className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"right",children:"Правая"}),(0,a.jsx)("option",{value:"left",children:"Левая"}),(0,a.jsx)("option",{value:"both",children:"Обе"})]})]})]})]},e.id||s))]}),"process"===z&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"call_date1",className:"block text-sm font-medium text-gray-700",children:"Дата вызова 1"}),(0,a.jsx)("input",{type:"date",name:"call_date1",id:"call_date1",value:u.call_date1||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"call_date2",className:"block text-sm font-medium text-gray-700",children:"Дата вызова 2"}),(0,a.jsx)("input",{type:"date",name:"call_date2",id:"call_date2",value:u.call_date2||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"call_date3",className:"block text-sm font-medium text-gray-700",children:"Дата вызова 3"}),(0,a.jsx)("input",{type:"date",name:"call_date3",id:"call_date3",value:u.call_date3||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"come_date1",className:"block text-sm font-medium text-gray-700",children:"Дата прихода 1"}),(0,a.jsx)("input",{type:"date",name:"come_date1",id:"come_date1",value:u.come_date1||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"come_date2",className:"block text-sm font-medium text-gray-700",children:"Дата прихода 2"}),(0,a.jsx)("input",{type:"date",name:"come_date2",id:"come_date2",value:u.come_date2||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"come_date3",className:"block text-sm font-medium text-gray-700",children:"Дата прихода 3"}),(0,a.jsx)("input",{type:"date",name:"come_date3",id:"come_date3",value:u.come_date3||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"accept_date",className:"block text-sm font-medium text-gray-700",children:"Дата принятия"}),(0,a.jsx)("input",{type:"date",name:"accept_date",id:"accept_date",value:u.accept_date||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"ready_date",className:"block text-sm font-medium text-gray-700",children:"Дата готовности"}),(0,a.jsx)("input",{type:"date",name:"ready_date",id:"ready_date",value:u.ready_date||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"issue_date",className:"block text-sm font-medium text-gray-700",children:"Дата выдачи"}),(0,a.jsx)("input",{type:"date",name:"issue_date",id:"issue_date",value:u.issue_date||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"direct_to_approve_date",className:"block text-sm font-medium text-gray-700",children:"Дата направления на утверждение"}),(0,a.jsx)("input",{type:"date",name:"direct_to_approve_date",id:"direct_to_approve_date",value:u.direct_to_approve_date||"",onChange:D,className:"mt-1 block w-full input"})]}),"shoes"===u.order_type&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"shoe_model_id",className:"block text-sm font-medium text-gray-700",children:"Модель обуви"}),(0,a.jsxs)("select",{name:"shoe_model_id",id:"shoe_model_id",value:u.shoe_model_id||"",onChange:D,className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"",children:"Выберите модель"}),N.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"shoe_color_id",className:"block text-sm font-medium text-gray-700",children:"Цвет обуви"}),(0,a.jsxs)("select",{name:"shoe_color_id",id:"shoe_color_id",value:u.shoe_color_id||"",onChange:D,className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"",children:"Выберите цвет"}),w.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"heel_material_id",className:"block text-sm font-medium text-gray-700",children:"Материал каблука"}),(0,a.jsxs)("select",{name:"heel_material_id",id:"heel_material_id",value:u.heel_material_id||"",onChange:D,className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"",children:"Выберите материал"}),C.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"size_of_shortening",className:"block text-sm font-medium text-gray-700",children:"Размер укорочения (см)"}),(0,a.jsx)("input",{type:"number",name:"size_of_shortening",id:"size_of_shortening",min:"0",step:"0.1",value:u.size_of_shortening||"",onChange:D,className:"mt-1 block w-full input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"shoe_order_type",className:"block text-sm font-medium text-gray-700",children:"Тип заказа обуви"}),(0,a.jsxs)("select",{name:"shoe_order_type",id:"shoe_order_type",value:u.shoe_order_type||"",onChange:D,className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"",children:"Выберите тип"}),(0,a.jsx)("option",{value:"standard",children:"Стандартная"}),(0,a.jsx)("option",{value:"custom",children:"Индивидуальная"}),(0,a.jsx)("option",{value:"repair",children:"Ремонт"})]})]})]})]})})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[(0,a.jsx)("button",{type:"button",onClick:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Отмена"}),(0,a.jsx)("button",{type:"submit",disabled:F,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:F?"Сохранение...":r?"Сохранить изменения":"Создать заказ"})]})]})]})})}var h=t(6191),u=t(86651),p=t(26983),g=t(42529),y=t(52056),j=t(11010),b=t(71360),v=t(24947),f=t(71847);let N=(0,f.A)("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),_=(0,f.A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);function w(e){let{orderId:s,onSave:t,onCancel:r}=e,[c,o]=(0,l.useState)({wheelchair:!1,wheelchair_type:"",hearing_aid:!1,hearing_aid_type:"",pgj:!1,pgj_type:"",other:!1,other_description:""});(0,l.useEffect)(()=>{m()},[s]);let m=async()=>{try{let e=await i.u.getReadyPOI(s);e&&o({wheelchair:e.wheelchair||!1,wheelchair_type:e.wheelchair_type||"",hearing_aid:e.hearing_aid||!1,hearing_aid_type:e.hearing_aid_type||"",pgj:e.pgj||!1,pgj_type:e.pgj_type||"",other:e.other||!1,other_description:e.other_description||""})}catch(e){console.error("Failed to load ready POI:",e)}},x=async e=>{e.preventDefault();try{let e=await i.u.updateReadyPOI(s,c);t(e)}catch(e){console.error("Failed to save ready POI:",e)}},h=(e,s)=>{o(t=>({...t,[e]:s,["".concat(e,"_type")]:s?t["".concat(e,"_type")]:""}))};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-5 w-5 mr-2"}),"Готовые протезно-ортопедические изделия"]}),(0,a.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(d.A,{className:"h-6 w-6"})})]}),(0,a.jsxs)("form",{onSubmit:x,className:"p-6",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(v.A,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:c.wheelchair,onChange:e=>h("wheelchair",e.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Кресло-коляска"})]})]}),c.wheelchair&&(0,a.jsxs)("div",{className:"ml-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип кресла-коляски"}),(0,a.jsxs)("select",{value:c.wheelchair_type,onChange:e=>o(s=>({...s,wheelchair_type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Выберите тип"}),(0,a.jsx)("option",{value:"Инвалидная коляска",children:"Инвалидная коляска"}),(0,a.jsx)("option",{value:"Кресло-коляска активного типа",children:"Кресло-коляска активного типа"}),(0,a.jsx)("option",{value:"Кресло-коляска с электроприводом",children:"Кресло-коляска с электроприводом"}),(0,a.jsx)("option",{value:"Кресло-коляска для детей",children:"Кресло-коляска для детей"})]})]})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(N,{className:"h-5 w-5 text-green-600 mr-2"}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:c.hearing_aid,onChange:e=>h("hearing_aid",e.target.checked),className:"mr-2 h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Слуховой аппарат"})]})]}),c.hearing_aid&&(0,a.jsxs)("div",{className:"ml-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип слухового аппарата"}),(0,a.jsxs)("select",{value:c.hearing_aid_type,onChange:e=>o(s=>({...s,hearing_aid_type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,a.jsx)("option",{value:"",children:"Выберите тип"}),(0,a.jsx)("option",{value:"Заушный",children:"Заушный"}),(0,a.jsx)("option",{value:"Внутриушной",children:"Внутриушной"}),(0,a.jsx)("option",{value:"Карманный",children:"Карманный"}),(0,a.jsx)("option",{value:"Костный",children:"Костный"}),(0,a.jsx)("option",{value:"Цифровой",children:"Цифровой"})]})]})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(_,{className:"h-5 w-5 text-red-600 mr-2"}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:c.pgj,onChange:e=>h("pgj",e.target.checked),className:"mr-2 h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"ПГЖ (Протез грудной железы)"})]})]}),c.pgj&&(0,a.jsxs)("div",{className:"ml-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Тип ПГЖ"}),(0,a.jsxs)("select",{value:c.pgj_type,onChange:e=>o(s=>({...s,pgj_type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",children:[(0,a.jsx)("option",{value:"",children:"Выберите тип"}),(0,a.jsx)("option",{value:"Силиконовый",children:"Силиконовый"}),(0,a.jsx)("option",{value:"Полиуретановый",children:"Полиуретановый"}),(0,a.jsx)("option",{value:"Текстильный",children:"Текстильный"}),(0,a.jsx)("option",{value:"С самофиксацией",children:"С самофиксацией"})]})]})]}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(n.A,{className:"h-5 w-5 text-purple-600 mr-2"}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:c.other,onChange:e=>h("other",e.target.checked),className:"mr-2 h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Другие изделия"})]})]}),c.other&&(0,a.jsxs)("div",{className:"ml-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Описание других изделий"}),(0,a.jsx)("textarea",{value:c.other_description,onChange:e=>o(s=>({...s,other_description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",rows:3,placeholder:"Опишите другие протезно-ортопедические изделия"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Отмена"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Сохранить"})]})]})]})})}function k(){let[e,s]=(0,l.useState)([]),[t,d]=(0,l.useState)(!0),[c,o]=(0,l.useState)(""),[m,v]=(0,l.useState)(""),[f,N]=(0,l.useState)(""),[_,k]=(0,l.useState)(null),[C,A]=(0,l.useState)(!1),[F,S]=(0,l.useState)(null),[q,M]=(0,l.useState)([]);(0,l.useEffect)(()=>{z()},[c,m,f]);let z=async()=>{try{d(!0);let e={};c&&(e.search=c),m&&(e.order_type=m),f&&(e.status=f);let t=await i.u.getOrders(e);s(t.results)}catch(e){console.error("Failed to load orders:",e)}finally{d(!1)}},O=async e=>{try{if(F){let t=await i.u.updateOrder(F.id,e);s(e=>e.map(e=>e.id===F.id?t:e))}else{let t=await i.u.createOrder(e);s(e=>[t,...e])}A(!1),S(null)}catch(e){console.error("Failed to save order:",e)}},D=async e=>{if(window.confirm("Вы уверены, что хотите удалить этот заказ?"))try{await i.u.deleteOrder(e),s(s=>s.filter(s=>s.id!==e))}catch(e){console.error("Failed to delete order:",e)}},P=async(t,a)=>{try{let l=e.find(e=>e.id===t);if(l){let e=await i.u.updateOrder(t,{...l,status:a});s(s=>s.map(s=>s.id===t?e:s))}}catch(e){console.error("Failed to update status:",e)}},H=async t=>{if(0!==q.length)try{let a=q.map(s=>{let a=e.find(e=>e.id===s);return a?i.u.updateOrder(s,{...a,status:t}):Promise.resolve()});await Promise.all(a),s(e=>e.map(e=>q.includes(e.id)?{...e,status:t}:e)),M([])}catch(e){console.error("Failed to update statuses:",e)}};return(0,a.jsxs)(r.A,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Управление заказами"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Создание и управление заказами на протезно-ортопедические изделия"})]}),(0,a.jsxs)("button",{onClick:()=>{S(null),A(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 flex items-center",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Новый заказ"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-md bg-blue-100",children:(0,a.jsx)(n.A,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Всего заказов"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.length})]})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-md bg-yellow-100",children:(0,a.jsx)("div",{className:"h-6 w-6 text-yellow-600",children:"⚙️"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"В работе"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.filter(e=>2===e.status).length})]})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-md bg-green-100",children:(0,a.jsx)("div",{className:"h-6 w-6 text-green-600",children:"✅"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Готово"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.filter(e=>e.status>=3).length})]})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-md bg-red-100",children:(0,a.jsx)("div",{className:"h-6 w-6 text-red-600",children:"⚠️"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Просрочено"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:"0"})]})]})})]}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("select",{className:"input",value:m,onChange:e=>v(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Все типы"}),(0,a.jsx)("option",{value:"prosthesis",children:"Протезы"}),(0,a.jsx)("option",{value:"shoes",children:"Обувь"}),(0,a.jsx)("option",{value:"orthopedic",children:"Ортопедические"}),(0,a.jsx)("option",{value:"repair",children:"Ремонт"}),(0,a.jsx)("option",{value:"ready_poi",children:"Готовые ПОИ"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{className:"input",value:f,onChange:e=>N(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Все статусы"}),(0,a.jsx)("option",{value:"1",children:"Новый"}),(0,a.jsx)("option",{value:"2",children:"В работе"}),(0,a.jsx)("option",{value:"3",children:"Готов"}),(0,a.jsx)("option",{value:"4",children:"На складе"}),(0,a.jsx)("option",{value:"5",children:"Выдан"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Поиск по номеру, ФИО...",className:"input pl-10",value:c,onChange:e=>o(e.target.value)})]})})]})}),q.length>0&&(0,a.jsx)("div",{className:"card p-4 bg-blue-50 border border-blue-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:["Выбрано заказов: ",q.length]})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>H(2),className:"bg-yellow-600 text-white px-3 py-1 rounded text-sm hover:bg-yellow-700 flex items-center",children:[(0,a.jsx)(p.A,{className:"h-3 w-3 mr-1"}),"В работу"]}),(0,a.jsxs)("button",{onClick:()=>H(3),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 flex items-center",children:[(0,a.jsx)(g.A,{className:"h-3 w-3 mr-1"}),"Готово"]}),(0,a.jsx)("button",{onClick:()=>M([]),className:"bg-gray-600 text-white px-3 py-1 rounded text-sm hover:bg-gray-700",children:"Отменить"})]})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,a.jsx)("input",{type:"checkbox",checked:q.length===e.length&&e.length>0,onChange:()=>{q.length===e.length?M([]):M(e.map(e=>e.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"№ заказа"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Пациент"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Тип"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Изделие"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Дата создания"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:8,className:"px-6 py-4 text-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"})})}):0===e.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:8,className:"px-6 py-4 text-center text-gray-500",children:"Заказы не найдены"})}):e.map(e=>{var s,t,l,r,i;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 ".concat(q.includes(e.id)?"bg-blue-50":""),children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("input",{type:"checkbox",checked:q.includes(e.id),onChange:()=>{var s;return s=e.id,void M(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.number}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium",children:[(null==(s=e.cart)?void 0:s.first_name)||""," ",(null==(t=e.cart)?void 0:t.name)||""]}),(0,a.jsxs)("div",{className:"text-gray-500 text-xs",children:["№",(null==(l=e.cart)?void 0:l.card_number)||"Не указан"]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:{prosthesis:"Протез",shoes:"Обувь",orthopedic:"Ортопедическое",repair:"Ремонт"}[i=e.order_type]||i}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(null==(r=e.device_type)?void 0:r.name)||"Не указан"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:{1:"badge badge-info",2:"badge badge-warning",3:"badge badge-success",4:"badge badge-success",5:"badge badge-success",6:"badge badge-info"}[e.status]||"badge badge-info",children:{1:"Новый",2:"В работе",3:"Готов",4:"На складе",5:"Выдан",6:"Выдан"}[e.status]||"Неизвестно"}),e.is_urgent&&(0,a.jsx)(y.A,{className:"h-4 w-4 text-red-500"})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.created_at?new Date(e.created_at).toLocaleDateString("ru-RU"):"Не указано"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>{S(e),A(!0)},className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-100",title:"Редактировать",children:(0,a.jsx)(j.A,{className:"h-4 w-4"})}),"ready_poi"===e.order_type&&(0,a.jsx)("button",{onClick:()=>k(e.id),className:"text-purple-600 hover:text-purple-900 p-1 rounded hover:bg-purple-100",title:"Готовые ПОИ",children:(0,a.jsx)(n.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>P(e.id,1===e.status?2:e.status+1),className:"text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-100",title:"Изменить статус",children:(0,a.jsx)(g.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>D(e.id),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-100",title:"Удалить",children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]})})]},e.id)})})]})})})]}),C&&(0,a.jsx)(x,{order:F||void 0,onSave:O,onCancel:()=>{A(!1),S(null)}}),_&&(0,a.jsx)(w,{orderId:_,onSave:()=>k(null),onCancel:()=>k(null)})]})}},86651:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},e=>{e.O(0,[310,706,441,255,358],()=>e(e.s=20596)),_N_E=e.O()}]);