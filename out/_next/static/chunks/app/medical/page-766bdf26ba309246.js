(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[202],{6191:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},11010:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},11361:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>S});var a=t(95155),l=t(12115),r=t(64615),i=t(7744),n=t(65229),d=t(89715),c=t(52056),x=t(42529);function o(e){var s,t,r,o,m,h,u,p;let{order:g,onSave:j,onCancel:y}=e,[b,f]=(0,l.useState)({medical_diagnosis:"",medical_recommendations:"",medical_conclusion:"",medical_notes:"",examination_date:new Date().toISOString().split("T")[0],doctor_name:"",doctor_specialty:"",is_approved:!1,rejection_reason:"",requires_additional_examination:!1,additional_examination_notes:"",follow_up_date:"",priority_level:"normal"}),[N,v]=(0,l.useState)(!1),[w,_]=(0,l.useState)({}),[k,A]=(0,l.useState)("examination"),C=e=>{let{name:s,value:t,type:a}=e.target,l="checked"in e.target&&e.target.checked;f(e=>({...e,[s]:"checkbox"===a?l:t})),w[s]&&_(e=>({...e,[s]:""}))},S=async e=>{if(e.preventDefault(),(()=>{let e={};return b.medical_diagnosis.trim()||(e.medical_diagnosis="Медицинский диагноз обязателен"),b.doctor_name.trim()||(e.doctor_name="ФИО врача обязательно"),b.doctor_specialty.trim()||(e.doctor_specialty="Специальность врача обязательна"),b.is_approved||b.rejection_reason.trim()||(e.rejection_reason="При отклонении необходимо указать причину"),b.requires_additional_examination&&!b.additional_examination_notes.trim()&&(e.additional_examination_notes="При назначении дополнительного обследования необходимо указать детали"),_(e),0===Object.keys(e).length})())try{v(!0);let e={...b,order_id:g.id,examination_date:new Date(b.examination_date).toISOString(),follow_up_date:b.follow_up_date?new Date(b.follow_up_date).toISOString():null};await j(e)}catch(e){console.error("Failed to save examination:",e)}finally{v(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.A,{className:"h-6 w-6 text-blue-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Медицинский осмотр"}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Заказ №",g.number," - ",(null==(s=g.cart)?void 0:s.first_name)||""," ",(null==(t=g.cart)?void 0:t.name)||""]})]})]}),(0,a.jsx)("button",{onClick:y,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(n.A,{className:"h-6 w-6"})})]}),(0,a.jsxs)("form",{onSubmit:S,className:"overflow-y-auto max-h-[calc(90vh-120px)]",children:[(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-blue-900 mb-3",children:"Информация о заказе"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Пациент:"}),(0,a.jsxs)("p",{className:"text-blue-700",children:[(null==(r=g.cart)?void 0:r.first_name)||""," ",(null==(o=g.cart)?void 0:o.name)||""," ",(null==(m=g.cart)?void 0:m.parent_name)||""]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"ИНН:"}),(0,a.jsx)("p",{className:"text-blue-700",children:(null==(h=g.cart)?void 0:h.inn)||"Не указан"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Тип изделия:"}),(0,a.jsx)("p",{className:"text-blue-700",children:(null==(u=g.device_type)?void 0:u.name)||"Не указан"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Диагноз:"}),(0,a.jsx)("p",{className:"text-blue-700",children:(null==(p=g.diagnosis_type)?void 0:p.name)||"Не указан"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Сторона:"}),(0,a.jsx)("p",{className:"text-blue-700",children:"right"===g.diagnosis_side?"Правая":"left"===g.diagnosis_side?"Левая":"Обе"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Количество:"}),(0,a.jsx)("p",{className:"text-blue-700",children:g.quantity})]})]})]}),(0,a.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>A("examination"),className:"".concat("examination"===k?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"," whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium"),children:[(0,a.jsx)(i.A,{className:"h-4 w-4 inline mr-2"}),"Осмотр"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>A("conclusion"),className:"".concat("conclusion"===k?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"," whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium"),children:[(0,a.jsx)(d.A,{className:"h-4 w-4 inline mr-2"}),"Заключение"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>A("recommendations"),className:"".concat("recommendations"===k?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"," whitespace-nowrap border-b-2 py-4 px-1 text-sm font-medium"),children:[(0,a.jsx)(c.A,{className:"h-4 w-4 inline mr-2"}),"Рекомендации"]})]})}),"examination"===k&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"examination_date",className:"block text-sm font-medium text-gray-700",children:["Дата осмотра ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"date",name:"examination_date",id:"examination_date",value:b.examination_date,onChange:C,className:"mt-1 block w-full input",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"doctor_name",className:"block text-sm font-medium text-gray-700",children:["ФИО врача ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",name:"doctor_name",id:"doctor_name",value:b.doctor_name,onChange:C,className:"mt-1 block w-full input ".concat(w.doctor_name?"border-red-500":""),placeholder:"Введите ФИО врача",required:!0}),w.doctor_name&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.doctor_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"doctor_specialty",className:"block text-sm font-medium text-gray-700",children:["Специальность врача ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",name:"doctor_specialty",id:"doctor_specialty",value:b.doctor_specialty,onChange:C,className:"mt-1 block w-full input ".concat(w.doctor_specialty?"border-red-500":""),placeholder:"Например: Врач-ортопед",required:!0}),w.doctor_specialty&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.doctor_specialty})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"priority_level",className:"block text-sm font-medium text-gray-700",children:"Приоритет"}),(0,a.jsxs)("select",{name:"priority_level",id:"priority_level",value:b.priority_level,onChange:C,className:"mt-1 block w-full input",children:[(0,a.jsx)("option",{value:"normal",children:"Обычный"}),(0,a.jsx)("option",{value:"high",children:"Высокий"}),(0,a.jsx)("option",{value:"urgent",children:"Срочный"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"medical_diagnosis",className:"block text-sm font-medium text-gray-700",children:["Медицинский диагноз ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("textarea",{name:"medical_diagnosis",id:"medical_diagnosis",rows:4,value:b.medical_diagnosis,onChange:C,className:"mt-1 block w-full input ".concat(w.medical_diagnosis?"border-red-500":""),placeholder:"Опишите медицинский диагноз пациента...",required:!0}),w.medical_diagnosis&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.medical_diagnosis})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"medical_notes",className:"block text-sm font-medium text-gray-700",children:"Заметки врача"}),(0,a.jsx)("textarea",{name:"medical_notes",id:"medical_notes",rows:3,value:b.medical_notes,onChange:C,className:"mt-1 block w-full input",placeholder:"Дополнительные заметки о состоянии пациента..."})]})]}),"conclusion"===k&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(c.A,{className:"h-5 w-5 text-yellow-600 mr-2"}),(0,a.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Решение по заказу"})]}),(0,a.jsx)("p",{className:"mt-1 text-sm text-yellow-700",children:"Выберите решение по данному заказу на основе медицинского осмотра"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"is_approved",id:"approve",value:"true",checked:!0===b.is_approved,onChange:()=>f(e=>({...e,is_approved:!0})),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300"}),(0,a.jsxs)("label",{htmlFor:"approve",className:"ml-3 flex items-center",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 text-green-600 mr-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Утвердить заказ"})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",name:"is_approved",id:"reject",value:"false",checked:!1===b.is_approved,onChange:()=>f(e=>({...e,is_approved:!1})),className:"h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300"}),(0,a.jsxs)("label",{htmlFor:"reject",className:"ml-3 flex items-center",children:[(0,a.jsx)(n.A,{className:"h-5 w-5 text-red-600 mr-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Отклонить заказ"})]})]})]}),!b.is_approved&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"rejection_reason",className:"block text-sm font-medium text-gray-700",children:["Причина отклонения ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("textarea",{name:"rejection_reason",id:"rejection_reason",rows:3,value:b.rejection_reason,onChange:C,className:"mt-1 block w-full input ".concat(w.rejection_reason?"border-red-500":""),placeholder:"Укажите причину отклонения заказа...",required:!b.is_approved}),w.rejection_reason&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.rejection_reason})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"medical_conclusion",className:"block text-sm font-medium text-gray-700",children:"Медицинское заключение"}),(0,a.jsx)("textarea",{name:"medical_conclusion",id:"medical_conclusion",rows:4,value:b.medical_conclusion,onChange:C,className:"mt-1 block w-full input",placeholder:"Подробное медицинское заключение..."})]})]}),"recommendations"===k&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",name:"requires_additional_examination",id:"requires_additional_examination",checked:b.requires_additional_examination,onChange:C,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"requires_additional_examination",className:"ml-2 block text-sm text-gray-900",children:"Требуется дополнительное обследование"})]}),b.requires_additional_examination&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"additional_examination_notes",className:"block text-sm font-medium text-gray-700",children:["Детали дополнительного обследования ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("textarea",{name:"additional_examination_notes",id:"additional_examination_notes",rows:3,value:b.additional_examination_notes,onChange:C,className:"mt-1 block w-full input ".concat(w.additional_examination_notes?"border-red-500":""),placeholder:"Опишите, какое дополнительное обследование требуется...",required:b.requires_additional_examination}),w.additional_examination_notes&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.additional_examination_notes})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"medical_recommendations",className:"block text-sm font-medium text-gray-700",children:"Рекомендации по лечению"}),(0,a.jsx)("textarea",{name:"medical_recommendations",id:"medical_recommendations",rows:4,value:b.medical_recommendations,onChange:C,className:"mt-1 block w-full input",placeholder:"Рекомендации по лечению и реабилитации..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"follow_up_date",className:"block text-sm font-medium text-gray-700",children:"Дата повторного осмотра"}),(0,a.jsx)("input",{type:"date",name:"follow_up_date",id:"follow_up_date",value:b.follow_up_date,onChange:C,className:"mt-1 block w-full input"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:[(0,a.jsx)("button",{type:"button",onClick:y,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Отмена"}),(0,a.jsx)("button",{type:"submit",disabled:N,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Сохранение...":"Сохранить осмотр"})]})]})]})})}var m=t(78894),h=t(26617),u=t(6191),p=t(71847);let g=(0,p.A)("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),j=(0,p.A)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);var y=t(11010),b=t(71360);function f(e){let{orderId:s,products:t,onUpdate:r}=e,[i,n]=(0,l.useState)(!1),[d,c]=(0,l.useState)(null),[x,o]=(0,l.useState)({name:"",code:"",size:"",quantity_left:0,quantity_right:0,is_mold:!1}),p=async()=>{try{d?console.log("Updating product:",d.id,x):await m.u.addSemiFinishedProduct(s,x),n(!1),r()}catch(e){console.error("Failed to save product:",e)}};return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 mr-2"}),"Полуфабрикаты"]}),(0,a.jsxs)("button",{onClick:()=>{c(null),o({name:"",code:"",size:"",quantity_left:0,quantity_right:0,is_mold:!1}),n(!0)},className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Добавить полуфабрикат"]})]}),0===t.length?(0,a.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Полуфабрикаты не добавлены"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Наименование"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Шифр"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Размер"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Левый"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Правый"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Слепок"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.code}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.size}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.quantity_left}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.quantity_right}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.is_mold?(0,a.jsx)(g,{className:"h-4 w-4 text-green-600"}):(0,a.jsx)(j,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{c(e),o({name:e.name,code:e.code,size:e.size,quantity_left:e.quantity_left,quantity_right:e.quantity_right,is_mold:e.is_mold}),n(!0)},className:"text-blue-600 hover:text-blue-800",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>{confirm("Удалить полуфабрикат?")&&console.log("Deleting product:",e.id)},className:"text-red-600 hover:text-red-800",children:(0,a.jsx)(b.A,{className:"h-4 w-4"})})]})})]},e.id))})]})}),i&&(0,a.jsxs)("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-4",children:d?"Редактировать полуфабрикат":"Добавить полуфабрикат"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Наименование полуфабриката *"}),(0,a.jsx)("input",{type:"text",value:x.name,onChange:e=>o(s=>({...s,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Введите наименование",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Шифр полуфабриката *"}),(0,a.jsx)("input",{type:"text",value:x.code,onChange:e=>o(s=>({...s,code:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Введите шифр",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Размер *"}),(0,a.jsx)("input",{type:"text",value:x.size,onChange:e=>o(s=>({...s,size:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Введите размер",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Количество левый *"}),(0,a.jsx)("input",{type:"number",min:"0",value:x.quantity_left,onChange:e=>o(s=>({...s,quantity_left:parseInt(e.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Количество правый *"}),(0,a.jsx)("input",{type:"number",min:"0",value:x.quantity_right,onChange:e=>o(s=>({...s,quantity_right:parseInt(e.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:x.is_mold,onChange:e=>o(s=>({...s,is_mold:e.target.checked})),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Слепок"})]})})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-4",children:[(0,a.jsx)("button",{onClick:()=>{n(!1),c(null)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Отмена"}),(0,a.jsx)("button",{onClick:p,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:d?"Обновить":"Добавить"})]})]})]})}var N=t(20508),v=t(16485);function w(e){var s,t,r,d,x,o,u,p,g,j,y,b,w,_,k,A,C,S,q,F,z,D,M,O,L,U,R,E;let{order:I,onClose:P}=e,[H,T]=(0,l.useState)([]),[V,B]=(0,l.useState)(!1);(0,l.useEffect)(()=>{"prosthesis"===I.order_type&&X()},[I.id,I.order_type]);let X=async()=>{try{B(!0);let e=await m.u.getSemiFinishedProducts(I.id);T(e)}catch(e){console.error("Failed to load semi-finished products:",e)}finally{B(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.A,{className:"h-6 w-6 text-blue-600 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Детали заказа №",I.number]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[(null==(s=I.cart)?void 0:s.first_name)||""," ",(null==(t=I.cart)?void 0:t.name)||""," ",(null==(r=I.cart)?void 0:r.parent_name)||""]})]})]}),(0,a.jsx)("button",{onClick:P,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(n.A,{className:"h-6 w-6"})})]}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-blue-900 mb-4 flex items-center",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 mr-2"}),"Информация о заказе"]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Номер заказа:"}),(0,a.jsx)("span",{className:"text-blue-700",children:I.number})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Тип заказа:"}),(0,a.jsx)("span",{className:"text-blue-700",children:I.order_type})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Тип изделия:"}),(0,a.jsx)("span",{className:"text-blue-700",children:(null==(d=I.device_type)?void 0:d.name)||"Не указан"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Диагноз:"}),(0,a.jsx)("span",{className:"text-blue-700",children:(null==(x=I.diagnosis_type)?void 0:x.name)||"Не указан"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Сторона:"}),(0,a.jsx)("span",{className:"text-blue-700",children:"right"===I.diagnosis_side?"Правая":"left"===I.diagnosis_side?"Левая":"Обе"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Количество:"}),(0,a.jsx)("span",{className:"text-blue-700",children:I.quantity})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Статус:"}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat({1:"bg-blue-100 text-blue-800",2:"bg-yellow-100 text-yellow-800",3:"bg-green-100 text-green-800",4:"bg-red-100 text-red-800"}[I.status]||"bg-gray-100 text-gray-800"),children:{1:"На утверждении",2:"В работе",3:"Утвержден",4:"Отклонен"}[I.status]||"Неизвестно"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-blue-800",children:"Приоритет:"}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat({normal:"bg-gray-100 text-gray-800",high:"bg-yellow-100 text-yellow-800",urgent:"bg-red-100 text-red-800"}[I.priority_level||"normal"]||"bg-gray-100 text-gray-800"),children:{normal:"Обычный",high:"Высокий",urgent:"Срочный"}[I.priority_level||"normal"]||"Обычный"})]}),I.is_urgent&&(0,a.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{className:"font-medium",children:"Срочный заказ"})]})]})]}),(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-green-900 mb-4 flex items-center",children:[(0,a.jsx)(N.A,{className:"h-5 w-5 mr-2"}),"Информация о пациенте"]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-green-800",children:"ФИО:"}),(0,a.jsxs)("span",{className:"text-green-700",children:[(null==(o=I.cart)?void 0:o.name)||""," ",(null==(u=I.cart)?void 0:u.first_name)||""," ",(null==(p=I.cart)?void 0:p.parent_name)||""]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-green-800",children:"Номер карты:"}),(0,a.jsx)("span",{className:"text-green-700",children:(null==(g=I.cart)?void 0:g.card_number)||"Не указан"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-green-800",children:"ИНН:"}),(0,a.jsx)("span",{className:"text-green-700",children:(null==(j=I.cart)?void 0:j.inn)||"Не указан"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-green-800",children:"Дата рождения:"}),(0,a.jsx)("span",{className:"text-green-700",children:(null==(y=I.cart)?void 0:y.birth_date)?new Date(I.cart.birth_date).toLocaleDateString("ru-RU"):"Не указано"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-green-800",children:"Телефон:"}),(0,a.jsx)("span",{className:"text-green-700",children:(null==(b=I.cart)?void 0:b.phone_number)||"Не указан"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-green-800",children:"Адрес:"}),(0,a.jsx)("span",{className:"text-green-700",children:(null==(w=I.cart)?void 0:w.registration_address)||"Не указан"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[I.medical_examination?(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-yellow-900 mb-4 flex items-center",children:[(0,a.jsx)(i.A,{className:"h-5 w-5 mr-2"}),"Медицинский осмотр"]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-yellow-800",children:"Дата осмотра:"}),(0,a.jsx)("span",{className:"text-yellow-700",children:(null==(_=I.medical_examination)?void 0:_.examination_date)?new Date(I.medical_examination.examination_date).toLocaleDateString("ru-RU"):"Не указано"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-yellow-800",children:"Врач:"}),(0,a.jsx)("span",{className:"text-yellow-700",children:(null==(k=I.medical_examination)?void 0:k.doctor_name)||"Не указан"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-yellow-800",children:"Специальность:"}),(0,a.jsx)("span",{className:"text-yellow-700",children:(null==(A=I.medical_examination)?void 0:A.doctor_specialty)||"Не указана"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-yellow-800",children:"Решение:"}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat((null==(C=I.medical_examination)?void 0:C.is_approved)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:(null==(S=I.medical_examination)?void 0:S.is_approved)?"Утвержден":"Отклонен"})]})]}),(null==(q=I.medical_examination)?void 0:q.medical_diagnosis)&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"Медицинский диагноз:"}),(0,a.jsx)("p",{className:"text-yellow-700 text-sm bg-white p-3 rounded border",children:null==(F=I.medical_examination)?void 0:F.medical_diagnosis})]}),(null==(z=I.medical_examination)?void 0:z.medical_conclusion)&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"Заключение:"}),(0,a.jsx)("p",{className:"text-yellow-700 text-sm bg-white p-3 rounded border",children:null==(D=I.medical_examination)?void 0:D.medical_conclusion})]}),(null==(M=I.medical_examination)?void 0:M.medical_recommendations)&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"Рекомендации:"}),(0,a.jsx)("p",{className:"text-yellow-700 text-sm bg-white p-3 rounded border",children:null==(O=I.medical_examination)?void 0:O.medical_recommendations})]}),(null==(L=I.medical_examination)?void 0:L.rejection_reason)&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-red-800 mb-2",children:"Причина отклонения:"}),(0,a.jsx)("p",{className:"text-red-700 text-sm bg-white p-3 rounded border",children:null==(U=I.medical_examination)?void 0:U.rejection_reason})]}),(null==(R=I.medical_examination)?void 0:R.medical_notes)&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("h4",{className:"font-medium text-yellow-800 mb-2",children:"Заметки врача:"}),(0,a.jsx)("p",{className:"text-yellow-700 text-sm bg-white p-3 rounded border",children:null==(E=I.medical_examination)?void 0:E.medical_notes})]})]}):(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(i.A,{className:"h-5 w-5 mr-2"}),"Медицинский осмотр"]}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Медицинский осмотр не проводился"})]}),(0,a.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-purple-900 mb-4 flex items-center",children:[(0,a.jsx)(v.A,{className:"h-5 w-5 mr-2"}),"Процессные даты"]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-purple-800",children:"Дата создания:"}),(0,a.jsx)("span",{className:"text-purple-700",children:I.created_at?new Date(I.created_at).toLocaleDateString("ru-RU"):"Не указано"})]}),I.accept_date&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-purple-800",children:"Дата принятия:"}),(0,a.jsx)("span",{className:"text-purple-700",children:I.accept_date?new Date(I.accept_date).toLocaleDateString("ru-RU"):"Не указано"})]}),I.ready_date&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-purple-800",children:"Дата готовности:"}),(0,a.jsx)("span",{className:"text-purple-700",children:I.ready_date?new Date(I.ready_date).toLocaleDateString("ru-RU"):"Не указано"})]}),I.issue_date&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-medium text-purple-800",children:"Дата выдачи:"}),(0,a.jsx)("span",{className:"text-purple-700",children:I.issue_date?new Date(I.issue_date).toLocaleDateString("ru-RU"):"Не указано"})]})]})]})]})]})}),"prosthesis"===I.order_type&&(0,a.jsx)("div",{className:"p-6 border-t border-gray-200",children:(0,a.jsx)(f,{orderId:I.id,products:H,onUpdate:X})}),(0,a.jsx)("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 bg-gray-50",children:(0,a.jsx)("button",{onClick:P,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Закрыть"})})]})})}var _=t(63581),k=t(78874),A=t(86651),C=t(57828);function S(){let[e,s]=(0,l.useState)([]),[t,n]=(0,l.useState)(!0),[d,h]=(0,l.useState)(""),[u,p]=(0,l.useState)(""),[g,j]=(0,l.useState)(""),[y,b]=(0,l.useState)(""),[f,N]=(0,l.useState)(!1),[v,S]=(0,l.useState)(null),[q,F]=(0,l.useState)([]),[z,D]=(0,l.useState)(!1),[M,O]=(0,l.useState)(!1),[L,U]=(0,l.useState)(null);(0,l.useEffect)(()=>{R()},[d,u,g,y]);let R=async()=>{try{n(!0);let e={};d&&(e.search=d),u&&(e.status=u),g&&(e.priority=g),y&&(e.date=y);let t=await m.u.getMedicalOrders();s(t.results)}catch(e){console.error("Failed to load medical orders:",e)}finally{n(!1)}},E=async e=>{try{e.is_approved?await m.u.approveOrder(v.id,e):await m.u.rejectOrder(v.id,e),N(!1),S(null),R()}catch(e){console.error("Failed to save examination:",e)}},I=async e=>{try{await m.u.approveOrder(e),R()}catch(e){console.error("Failed to approve order:",e)}},P=async e=>{let s=prompt("Укажите причину отклонения:");if(s)try{await m.u.rejectOrder(e,{rejection_reason:s}),R()}catch(e){console.error("Failed to reject order:",e)}},H=async()=>{if(0!==q.length)try{let e=q.map(e=>m.u.approveOrder(e));await Promise.all(e),F([]),R()}catch(e){console.error("Failed to bulk approve orders:",e)}};return(0,a.jsxs)(r.A,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Медицинский отдел"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Направление пациентов на протезирование и утверждение заказов"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:()=>D(!z),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 flex items-center",children:[(0,a.jsx)(_.A,{className:"h-4 w-4 mr-2"}),"Фильтры"]}),q.length>0&&(0,a.jsxs)("button",{onClick:H,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 flex items-center",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Утвердить выбранные (",q.length,")"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-4",children:[(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-md bg-blue-100",children:(0,a.jsx)(i.A,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"На утверждении"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.filter(e=>1===e.status).length})]})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-md bg-green-100",children:(0,a.jsx)(x.A,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Утверждено"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.filter(e=>3===e.status).length})]})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-md bg-red-100",children:(0,a.jsx)(k.A,{className:"h-6 w-6 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Отклонено"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.filter(e=>4===e.status).length})]})]})}),(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-3 rounded-md bg-yellow-100",children:(0,a.jsx)(c.A,{className:"h-6 w-6 text-yellow-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Срочные"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:e.filter(e=>e.is_urgent).length})]})]})})]}),z&&(0,a.jsx)("div",{className:"card p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(A.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Поиск по ФИО, номеру...",className:"input pl-10",value:d,onChange:e=>h(e.target.value)})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{className:"input",value:u,onChange:e=>p(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Все статусы"}),(0,a.jsx)("option",{value:"1",children:"На утверждении"}),(0,a.jsx)("option",{value:"2",children:"В работе"}),(0,a.jsx)("option",{value:"3",children:"Утвержден"}),(0,a.jsx)("option",{value:"4",children:"Отклонен"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{className:"input",value:g,onChange:e=>j(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Все приоритеты"}),(0,a.jsx)("option",{value:"normal",children:"Обычный"}),(0,a.jsx)("option",{value:"high",children:"Высокий"}),(0,a.jsx)("option",{value:"urgent",children:"Срочный"})]})}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"date",className:"input",value:y,onChange:e=>b(e.target.value)})})]})}),(0,a.jsxs)("div",{className:"card p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Заказы на утверждении"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,a.jsx)("input",{type:"checkbox",checked:q.length===e.length&&e.length>0,onChange:()=>{q.length===e.length?F([]):F(e.map(e=>e.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"№ заказа"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Пациент"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Тип изделия"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Диагноз"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Приоритет"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Дата создания"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:9,className:"px-6 py-4 text-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"})})}):0===e.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:9,className:"px-6 py-4 text-center text-gray-500",children:"Нет заказов на утверждении"})}):e.map(e=>{var s,t,l,r,n;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 ".concat(q.includes(e.id)?"bg-blue-50":""),children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("input",{type:"checkbox",checked:q.includes(e.id),onChange:()=>{var s;return s=e.id,void F(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,a.jsxs)("div",{className:"flex items-center",children:[e.number,e.is_urgent&&(0,a.jsx)(c.A,{className:"h-4 w-4 text-red-500 ml-2"})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium",children:[(null==(s=e.cart)?void 0:s.first_name)||""," ",(null==(t=e.cart)?void 0:t.name)||""]}),(0,a.jsxs)("div",{className:"text-gray-500 text-xs",children:["№",(null==(l=e.cart)?void 0:l.card_number)||"Не указан"]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(null==(r=e.device_type)?void 0:r.name)||"Не указан"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(null==(n=e.diagnosis_type)?void 0:n.name)||"Не указан"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat({1:"bg-blue-100 text-blue-800",2:"bg-yellow-100 text-yellow-800",3:"bg-green-100 text-green-800",4:"bg-red-100 text-red-800"}[e.status]||"bg-gray-100 text-gray-800"),children:{1:"На утверждении",2:"В работе",3:"Утвержден",4:"Отклонен"}[e.status]||"Неизвестно"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat({normal:"bg-gray-100 text-gray-800",high:"bg-yellow-100 text-yellow-800",urgent:"bg-red-100 text-red-800"}[e.priority_level||"normal"]||"bg-gray-100 text-gray-800"),children:{normal:"Обычный",high:"Высокий",urgent:"Срочный"}[e.priority_level||"normal"]||"Обычный"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.created_at?new Date(e.created_at).toLocaleDateString("ru-RU"):"Не указано"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("button",{onClick:()=>{U(e),O(!0)},className:"text-gray-600 hover:text-gray-900 p-1 rounded hover:bg-gray-100",title:"Просмотр деталей",children:(0,a.jsx)(C.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>{S(e),N(!0)},className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-100",title:"Медицинский осмотр",children:(0,a.jsx)(i.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>I(e.id),className:"text-green-600 hover:text-green-900 p-1 rounded hover:bg-green-100",title:"Утвердить",children:(0,a.jsx)(x.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>P(e.id),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-100",title:"Отклонить",children:(0,a.jsx)(k.A,{className:"h-4 w-4"})})]})})]},e.id)})})]})})]})]}),f&&v&&(0,a.jsx)(o,{order:v,onSave:E,onCancel:()=>{N(!1),S(null)}}),M&&L&&(0,a.jsx)(w,{order:L,onClose:()=>{O(!1),U(null)}})]})}},16485:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},20508:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},30938:(e,s,t)=>{Promise.resolve().then(t.bind(t,11361))},42529:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},52056:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},57828:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},63581:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]])},64615:(e,s,t)=>{"use strict";t.d(s,{A:()=>N});var a=t(95155),l=t(12115),r=t(52619),i=t.n(r),n=t(95706),d=t(65993),c=t(91169),x=t(89715),o=t(7744),m=t(87066),h=t(26617),u=t(33),p=t(89559),g=t(15870),j=t(65229),y=t(9540),b=t(84926);let f=[{name:"Главная",href:"/",icon:d.A},{name:"Картотека",href:"/carts",icon:c.A},{name:"Заказы",href:"/orders",icon:x.A},{name:"Медицинский отдел",href:"/medical",icon:o.A},{name:"Накладные",href:"/overheads",icon:m.A},{name:"Склад",href:"/warehouse",icon:h.A},{name:"Отчеты",href:"/reports",icon:u.A},{name:"Интеграция",href:"/integration",icon:p.A},{name:"Настройки",href:"/settings",icon:g.A}];function N(e){var s;let{children:t}=e,{user:r,logout:d}=(0,n.A)(),[c,x]=(0,l.useState)(!1),o=async()=>{try{await d()}catch(e){console.error("Logout failed:",e)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:"fixed inset-0 z-50 lg:hidden ".concat(c?"block":"hidden"),children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>x(!1)}),(0,a.jsxs)("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white",children:[(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between px-4",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"РУПИО"}),(0,a.jsx)("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(j.A,{className:"h-6 w-6"})})]}),(0,a.jsx)("nav",{className:"flex-1 space-y-1 px-2 py-4",children:f.map(e=>{let s=e.icon;return(0,a.jsxs)(i(),{href:e.href,className:"group flex items-center px-2 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50 hover:text-gray-900",children:[(0,a.jsx)(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]})]}),(0,a.jsx)("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:(0,a.jsxs)("div",{className:"flex flex-col flex-grow bg-white border-r border-gray-200",children:[(0,a.jsx)("div",{className:"flex h-16 items-center px-4",children:(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"РУПИО"})}),(0,a.jsx)("nav",{className:"flex-1 space-y-1 px-2 py-4",children:f.map(e=>{let s=e.icon;return(0,a.jsxs)(i(),{href:e.href,className:"group flex items-center px-2 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50 hover:text-gray-900",children:[(0,a.jsx)(s,{className:"mr-3 h-5 w-5"}),e.name]},e.name)})})]})}),(0,a.jsxs)("div",{className:"lg:pl-64",children:[(0,a.jsxs)("div",{className:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-gray-200 bg-white px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8",children:[(0,a.jsx)("button",{type:"button",className:"-m-2.5 p-2.5 text-gray-700 lg:hidden",onClick:()=>x(!0),children:(0,a.jsx)(y.A,{className:"h-6 w-6"})}),(0,a.jsxs)("div",{className:"flex flex-1 gap-x-4 self-stretch lg:gap-x-6",children:[(0,a.jsx)("div",{className:"flex flex-1"}),(0,a.jsx)("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900",children:[null==r?void 0:r.first_name," ",null==r?void 0:r.last_name]}),(0,a.jsx)("div",{className:"text-gray-500",children:null==r||null==(s=r.role)?void 0:s.name})]}),(0,a.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(b.A,{className:"h-5 w-5"})})]})})]})]}),(0,a.jsx)("main",{className:"py-6",children:(0,a.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:t})})]})]})}},71360:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},78874:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},86651:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(71847).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},e=>{e.O(0,[310,706,441,255,358],()=>e(e.s=30938)),_N_E=e.O()}]);