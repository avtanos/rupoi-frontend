# Актуализированные роли пользователей АИС РУПОИ

## Обзор ролей согласно ТЗ

Система АИС РУПОИ предусматривает 6 основных ролей пользователей, каждая из которых имеет специфические права доступа и функциональные возможности согласно техническому заданию.

## 1. Администратор (ADMIN)

### Описание
Системные администраторы и руководство, имеющие полный доступ ко всем функциям системы.

### Основные функции
- ✅ Полный доступ ко всем модулям системы
- ✅ Управление пользователями и ролями
- ✅ Настройка системы и справочников
- ✅ Формирование всех типов отчетов
- ✅ Мониторинг системы и логи
- ✅ Резервное копирование данных
- ✅ Управление правами доступа
- ✅ Управление сотрудниками
- ✅ Доступ к интеграциям

### Права доступа
- `all` - полный доступ ко всем функциям

### Тестовые данные
- **Логин:** `admin`
- **Пароль:** `admin123`

## 2. Регистратор (REGISTRAR)

### Описание
Сотрудники регистратуры отвечают за первичный прием пациентов, создание и ведение персональных дел, а также управление архивом.

### Основные функции
- ✅ Создание персональных дел пациентов
- ✅ Редактирование персональных дел
- ✅ Поиск по ПИН, ФИО, статусу
- ✅ Просмотр истории оказания услуг
- ✅ Управление документами пациентов
- ✅ Ввод персональных данных
- ✅ Указание категории и группы инвалидности
- ✅ Управление архивом пациентов
- ✅ Восстановление из архива
- ✅ Снятие с учета

### Ограничения
- ❌ Не может создавать заказы
- ❌ Не может выписывать направления
- ❌ Не имеет доступа к складским операциям
- ❌ Не может формировать отчеты
- ❌ Не может управлять сотрудниками

### Права доступа
- `carts.read` - просмотр карточек пациентов
- `carts.create` - создание карточек пациентов
- `carts.update` - редактирование карточек пациентов
- `archive.read` - просмотр архива
- `archive.restore` - восстановление из архива

### Тестовые данные
- **Логин:** `registrar1`
- **Пароль:** `registrar123`

## 3. Медицинский работник (MEDICAL)

### Описание
Врачи-ортопеды и медицинский персонал, отвечающие за осмотр пациентов, назначение протезно-ортопедических изделий и создание медицинских направлений.

### Основные функции
- ✅ Просмотр персональных дел пациентов
- ✅ Создание направлений на услуги
- ✅ Утверждение/отклонение заказов
- ✅ Медицинские осмотры
- ✅ Назначение протезно-ортопедических изделий
- ✅ Создание медицинских направлений
- ✅ Оценка показаний
- ✅ Запрос дополнительных данных
- ✅ Формирование медицинских отчетов

### Ограничения
- ❌ Не может создавать персональные дела
- ❌ Не имеет доступа к складским операциям
- ❌ Не может управлять сотрудниками
- ❌ Не имеет доступа к административным функциям

### Права доступа
- `orders.medical.read` - просмотр заказов для медицинского отдела
- `orders.medical.approve` - утверждение заказов
- `medical.directions.create` - создание медицинских направлений
- `medical.directions.approve` - утверждение направлений
- `reports.medical` - формирование медицинских отчетов

### Тестовые данные
- **Логин:** `medical1`
- **Пароль:** `medical123`

## 4. Производственный работник (WORKSHOP)

### Описание
Мастера и производственный персонал, отвечающие за изготовление протезно-ортопедических изделий, управление заказами и создание накладных.

### Основные функции
- ✅ Просмотр заказов на производство
- ✅ Создание и обновление заказов
- ✅ Управление статусами заказов
- ✅ Назначение измерений
- ✅ Планирование материалов и работ
- ✅ Назначение сотрудников
- ✅ Отправка на примерку
- ✅ Передача на склад
- ✅ Создание накладных
- ✅ Формирование производственных отчетов

### Ограничения
- ❌ Не может создавать персональные дела
- ❌ Не может выписывать направления
- ❌ Не имеет доступа к административным функциям
- ❌ Не может управлять складскими остатками

### Права доступа
- `orders.workshop.read` - просмотр заказов для производства
- `orders.workshop.update` - обновление заказов
- `orders.workshop.create` - создание заказов
- `overheads.create` - создание накладных
- `overheads.update` - обновление накладных
- `reports.production` - формирование производственных отчетов

### Тестовые данные
- **Логин:** `workshop1`
- **Пароль:** `workshop123`

## 5. Складской работник (WAREHOUSE)

### Описание
Кладовщики и складской персонал, отвечающие за учет, хранение и выдачу готовой продукции, а также управление складскими операциями.

### Основные функции
- ✅ Просмотр накладных на готовую продукцию
- ✅ Прием готовых изделий на склад
- ✅ Выдача изделий пациентам
- ✅ Контроль складских остатков
- ✅ Управление складскими позициями
- ✅ Формирование складских отчетов
- ✅ Учет движения товаров
- ✅ Инвентаризация
- ✅ Управление материалами

### Ограничения
- ❌ Не может создавать персональные дела
- ❌ Не может выписывать направления
- ❌ Не может создавать заказы
- ❌ Не имеет доступа к административным функциям

### Права доступа
- `warehouse.read` - просмотр складских данных
- `warehouse.issue` - выдача со склада
- `warehouse.manage` - управление складом
- `overheads.warehouse.read` - просмотр накладных
- `overheads.warehouse.issue` - выдача по накладным
- `reports.warehouse` - формирование складских отчетов

### Тестовые данные
- **Логин:** `warehouse1`
- **Пароль:** `warehouse123`

## 6. Отчетный работник (REPORTS)

### Описание
Специалисты по отчетности, отвечающие за формирование различных типов отчетов и аналитики.

### Основные функции
- ✅ Формирование отчетов по ЛОВЗ
- ✅ Отчеты по изготовленным изделиям
- ✅ Медицинские отчеты
- ✅ Производственные отчеты
- ✅ Складские отчеты
- ✅ Аналитика и диаграммы
- ✅ Экспорт данных
- ✅ Сохранение пресетов отчетов
- ✅ Настройка параметров отчетов

### Ограничения
- ❌ Не может создавать персональные дела
- ❌ Не может выписывать направления
- ❌ Не может создавать заказы
- ❌ Не может управлять складом
- ❌ Не имеет доступа к административным функциям

### Права доступа
- `reports.read` - просмотр отчетов
- `reports.export` - экспорт отчетов
- `reports.medical` - медицинские отчеты
- `reports.production` - производственные отчеты
- `reports.warehouse` - складские отчеты

### Тестовые данные
- **Логин:** `reports1`
- **Пароль:** `reports123`

## Матрица прав доступа

| Функция | Админ | Регистратор | Медотдел | Производство | Склад | Отчеты |
|---------|-------|-------------|----------|--------------|-------|--------|
| **Персональные дела** | ✅ Полный доступ | ✅ Создание/редактирование | ✅ Просмотр | ❌ | ❌ | ❌ |
| **Архив пациентов** | ✅ Полный доступ | ✅ Просмотр/восстановление | ❌ | ❌ | ❌ | ❌ |
| **Медицинские направления** | ✅ Полный доступ | ❌ | ✅ Создание/утверждение | ❌ | ❌ | ❌ |
| **Заказы** | ✅ Полный доступ | ❌ | ✅ Утверждение | ✅ Создание/обновление | ✅ Просмотр | ❌ |
| **Накладные** | ✅ Полный доступ | ❌ | ❌ | ✅ Создание | ✅ Просмотр/выдача | ❌ |
| **Склад** | ✅ Полный доступ | ❌ | ❌ | ❌ | ✅ Управление | ❌ |
| **Сотрудники** | ✅ Управление | ❌ | ❌ | ❌ | ❌ | ❌ |
| **Отчеты** | ✅ Все отчеты | ❌ | ✅ Медицинские | ✅ Производственные | ✅ Складские | ✅ Все отчеты |
| **Настройки** | ✅ Полный доступ | ❌ | ❌ | ❌ | ❌ | ❌ |
| **Интеграция** | ✅ Полный доступ | ❌ | ❌ | ❌ | ❌ | ❌ |

## Workflow по ролям

### 1. Регистрация пациента (Регистратор)
1. Создание карточки пациента
2. Ввод персональных данных
3. Указание медицинской информации
4. Сохранение в системе

### 2. Медицинское направление (Медицинский работник)
1. Просмотр карточки пациента
2. Создание направления на услуги
3. Оценка показаний
4. Утверждение/отклонение

### 3. Создание заказа (Производственный работник)
1. Выбор пациента
2. Создание заказа
3. Назначение измерений
4. Планирование материалов и работ

### 4. Производство (Производственный работник)
1. Назначение сотрудников
2. Обновление статуса "В работе"
3. Отправка на примерку
4. Передача на склад

### 5. Складские операции (Складской работник)
1. Прием готовых изделий
2. Учет на складе
3. Выдача пациенту
4. Обновление остатков

### 6. Отчетность (Отчетный работник)
1. Выбор типа отчета
2. Настройка параметров
3. Формирование отчета
4. Экспорт данных

## Безопасность

- Все пароли хранятся в зашифрованном виде
- Сессии автоматически завершаются при неактивности
- Все действия пользователей логируются
- Роли проверяются на уровне API и UI
- Доступ к функциям ограничен согласно матрице прав

## Создание пользователей

Для создания пользователей с ролями используйте команду:

```bash
cd backend
python manage.py create_users
```

Или запустите скрипт настройки данных:

```bash
./setup_data.bat
```

## Изменения в ролях

### Обновления согласно ТЗ:
1. **Регистратор** - добавлен доступ к архиву пациентов
2. **Медицинский работник** - добавлены медицинские направления
3. **Производственный работник** - переименован в WORKSHOP, добавлены накладные
4. **Складской работник** - расширены права на складские операции
5. **Отчетный работник** - добавлены специализированные отчеты
6. **Администратор** - добавлено управление сотрудниками

### Новые права доступа:
- `archive.read` - просмотр архива
- `archive.restore` - восстановление из архива
- `medical.directions.create` - создание направлений
- `medical.directions.approve` - утверждение направлений
- `overheads.create` - создание накладных
- `overheads.update` - обновление накладных
- `warehouse.manage` - управление складом
- `reports.medical` - медицинские отчеты
- `reports.production` - производственные отчеты
- `reports.warehouse` - складские отчеты
